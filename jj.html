<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>'ã…‡ã…‡' ë°ì´í„° ì¼ê´„ ì‚­ì œê¸°</title>
</head>
<body>
  <h2>nameì´ 'ã…‡ã…‡'ì¸ ë°ì´í„°ë¥¼ ì‚­ì œ ì¤‘ì…ë‹ˆë‹¤... (F12 ì½˜ì†” í™•ì¸)</h2>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      query,
      orderByChild,
      equalTo,
      get,
      update
    } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBle_FLyJxn7v9AMQXlCo7U7hjcx88WrlU",
      authDomain: "knight-tour-ranking.firebaseapp.com",
      databaseURL: "https://knight-tour-ranking-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "knight-tour-ranking",
      storageBucket: "knight-tour-ranking.firebasestorage.app",
      messagingSenderId: "1073626351852",
      appId: "1:1073626351852:web:41ae6cb7db759beb703dc9",
      measurementId: "G-D2P9PJ00JT"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const boardSizes = ['5x5', '6x6', '7x7', '8x8'];
    const targetName = 'ã…‡ã…‡';

    async function deleteEntriesByName() {
      const allUpdates = {};
      let totalDeleted = 0;

      for (const size of boardSizes) {
        const path = `rankings/${size}`;
        const dataRef = ref(db, path);
        const queryRef = query(dataRef, orderByChild('name'), equalTo(targetName));

        console.log(`ğŸ” '${path}'ì—ì„œ nameì´ '${targetName}'ì¸ ë°ì´í„° ì°¾ëŠ” ì¤‘...`);

        try {
          const snapshot = await get(queryRef);
          if (snapshot.exists()) {
            let count = 0;
            snapshot.forEach(child => {
              const fullPath = `${path}/${child.key}`;
              allUpdates[fullPath] = null;
              count++;
            });
            totalDeleted += count;
            console.log(`âœ… ${count}ê°œ ì‚­ì œ ì¤€ë¹„ ì™„ë£Œ (${path})`);
          } else {
            console.log(`âŒ '${path}'ì— ì‚­ì œí•  '${targetName}' ë°ì´í„° ì—†ìŒ`);
          }
        } catch (err) {
          console.error(`âš ï¸ ${path} ì—ì„œ ì˜¤ë¥˜ ë°œìƒ:`, err);
        }
      }

      if (Object.keys(allUpdates).length > 0) {
        console.log(`ğŸš€ ì´ ${totalDeleted}ê°œ ë°ì´í„° ì‚­ì œ ì‹œì‘...`);
        try {
          await update(ref(db), allUpdates);
          console.log("ğŸ‰ ëª¨ë“  ì‚­ì œ ì™„ë£Œ!");
        } catch (err) {
          console.error("âŒ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", err);
        }
      } else {
        console.log("â„¹ï¸ ì‚­ì œí•  ë°ì´í„° ì—†ìŒ");
      }
    }

    deleteEntriesByName();
  </script>
</body>
</html>
