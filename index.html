<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ ê²Œì„ - ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2 ì²´í—˜</title>
  <meta name="description" content="ë„·í”Œë¦­ìŠ¤ ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2ì— ë“±ì¥í•œ ì²´ìŠ¤ í¼ì¦, ê¸°ì‚¬ì˜ ì—¬í–‰ì„ ì§ì ‘ ì²´í—˜í•´ë³´ì„¸ìš”. ë‚˜ì´íŠ¸ë¡œ ëª¨ë“  ì¹¸ì„ í•œ ë²ˆì”©ë§Œ ë°©ë¬¸í•˜ì„¸ìš”!" />
  <link rel="canonical" href="https://hoony8355.github.io/knight-tour-ko/" />
  <meta property="og:title" content="ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ ê²Œì„ - ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2 í¼ì¦" />
  <meta property="og:description" content="ë„·í”Œë¦­ìŠ¤ ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2ì—ì„œ í™”ì œê°€ ëœ ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ì„ ì§€ê¸ˆ ì§ì ‘ í’€ì–´ë³´ì„¸ìš”!" />
  <meta property="og:url" content="https://hoony8355.github.io/knight-tour-ko/" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/8/8c/Chess_knight.jpg" />
  <meta property="og:image:alt" content="ê¸°ì‚¬ì˜ ì—¬í–‰ ì²´ìŠ¤ í¼ì¦ ì´ë¯¸ì§€" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ ê²Œì„ - ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2 ì²´í—˜" />
  <meta name="twitter:description" content="ê¸°ì‚¬ì˜ ì—¬í–‰ì„ ë‚˜ì´íŠ¸ë¡œ ì²´í—˜í•´ë³´ê³ , ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2ì˜ ì£¼ì¸ê³µì²˜ëŸ¼ ë„ì „í•´ë³´ì„¸ìš”!" />
  <meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/8/8c/Chess_knight.jpg" />
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ ê²Œì„",
      "url": "https://hoony8355.github.io/knight-tour-ko/",
      "inLanguage": "ko",
      "description": "ë„·í”Œë¦­ìŠ¤ ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2ì— ë“±ì¥í•œ ì²´ìŠ¤ í¼ì¦ 'ê¸°ì‚¬ì˜ ì—¬í–‰'ì„ ì›¹ì—ì„œ ì²´í—˜í•´ë³´ì„¸ìš”.",
      "keywords": ["ê¸°ì‚¬ì˜ ì—¬í–‰", "ì²´ìŠ¤ í¼ì¦", "ë‚˜ì´íŠ¸ í¼ì¦", "ë°ë¸”ìŠ¤í”Œëœ ì‹œì¦Œ2", "knight tour"],
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {"@type": "ListItem", "position": 1, "name": "í™ˆ", "item": "https://hoony8355.github.io/"},
          {"@type": "ListItem", "position": 2, "name": "ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦", "item": "https://hoony8355.github.io/knight-tour-ko/"}
        ]
      }
    }
  </script>
  <style>
    body {
      font-family: sans-serif;
      background: #fff;
      color: #333;
      text-align: center;
      padding: 1em;
      overflow-x: hidden;
    }

    h1 { font-size: 1.8em; margin-bottom: 0.5em; }
    h2 { font-size: 1.4em; margin-top: 2em; }

    table {
      margin: auto;
      border-collapse: collapse;
      table-layout: fixed;
      max-width: 100%;
    }

    td {
      width: 45px;
      height: 45px;
      text-align: center;
      vertical-align: middle;
      font-weight: bold;
      cursor: pointer;
      box-sizing: border-box;
    }

    .light { background: #f0d9b5; }
    .dark { background: #b58863; color: white; }
    .current { outline: 3px solid orange; }
    .hint { box-shadow: inset 0 0 0 3px limegreen; }

    #status, #timer {
      margin-top: 1em;
      font-weight: bold;
    }

    #resetBtn, #undoBtn, #sizeSelect {
      margin-top: 1em;
      padding: 0.5em 1em;
      font: inherit;
      cursor: pointer;
    }

    #darkToggle {
      position: fixed;
      top: 10px;
      right: 10px;
    }

    #ranking {
      max-width: 500px;
      margin: 2em auto;
      text-align: left;
      border-top: 1px solid #ccc;
      padding-top: 1em;
    }

    #ranking h3 { margin-bottom: 0.5em; }
    #ranking ol { padding-left: 1em; }

    @media (max-width: 600px) {
      td {
        width: 12vw;
        height: 12vw;
        font-size: 0.75em;
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <button id="darkToggle">ğŸŒ™</button>
  <h1>ê¸°ì‚¬ì˜ ì—¬í–‰ í¼ì¦ ğŸ§©</h1>
  <p>í¼ì¦ì„ ì™„ì£¼í•œ ì‹œê°„ì„ ê¸°ë¡í•˜ê³  ì „ ì„¸ê³„ ì‚¬ëŒë“¤ê³¼ ê²½ìŸí•´ë³´ì„¸ìš”!</p>

  <label>ë³´ë“œ í¬ê¸° ì„ íƒ:
    <select id="sizeSelect">
      <option value="5">5x5</option>
      <option value="6">6x6</option>
      <option value="7">7x7</option>
      <option value="8" selected>8x8</option>
    </select>
  </label>

  <div id="status">ì‹œì‘í•  ì¹¸ì„ í´ë¦­í•˜ì„¸ìš”.</div>
  <div id="timer">ê²½ê³¼ ì‹œê°„: <span id="timeElapsed">0</span>ì´ˆ</div>
  <canvas id="confetti" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:999;display:none;"></canvas>
  <table id="board"></table>

  <div style="margin-top: 1em;">
    <button id="resetBtn">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
    <button id="undoBtn">â†©ï¸ ë˜ëŒë¦¬ê¸°</button>
  </div>

  <h2>ğŸ† ê¸€ë¡œë²Œ ë­í‚¹</h2>
  <ol id="rankingList"></ol>

  <div id="utterances-container" style="margin-top: 2em;">
    <h2>ğŸ’¬ ëŒ“ê¸€</h2>
    <script src="https://utteranc.es/client.js"
            repo="hoony8355/knight-tour-comments"
            issue-term="pathname"
            label="comment"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const undoBtn = document.getElementById('undoBtn');
    const sizeSelect = document.getElementById('sizeSelect');
    const timerEl = document.getElementById('timeElapsed');
    const rankingList = document.getElementById('rankingList');
    const confettiCanvas = document.getElementById('confetti');
    const darkToggle = document.getElementById('darkToggle');

    let board = [], current = null, moveCount = 0;
    let size = parseInt(sizeSelect.value);
    let startTime = null, timerInterval = null;
    let moveHistory = [];

    if (localStorage.theme === 'dark') {
      document.documentElement.style.setProperty('--bg', '#111');
      document.documentElement.style.setProperty('--fg', '#eee');
    }

    darkToggle.onclick = () => {
      const dark = localStorage.theme !== 'dark';
      localStorage.theme = dark ? 'dark' : 'light';
      document.documentElement.style.setProperty('--bg', dark ? '#111' : '#fff');
      document.documentElement.style.setProperty('--fg', dark ? '#eee' : '#000');
    };

    function startTimer() {
      startTime = Date.now();
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        const seconds = Math.floor((Date.now() - startTime) / 1000);
        timerEl.textContent = seconds;
      }, 1000);
    }

    function stopTimer() { clearInterval(timerInterval); }
    function clearHints() { document.querySelectorAll('.hint').forEach(el => el.classList.remove('hint')); }
    function showHints(x, y) {
      clearHints();
      knightMoves.forEach(([dx, dy]) => {
        const nx = x + dx, ny = y + dy;
        if (nx >= 0 && nx < size && ny >= 0 && ny < size && !board[ny][nx].visited) {
          board[ny][nx].el.classList.add('hint');
        }
      });
    }
    const knightMoves = [[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]];

    function onClick(e) {
      const x = +e.target.dataset.x;
      const y = +e.target.dataset.y;
      const square = board[y][x];
      if (square.visited) return;

      if (!current) startTimer();
      if (current) {
        const dx = Math.abs(x - current.x), dy = Math.abs(y - current.y);
        if (!((dx === 1 && dy === 2) || (dx === 2 && dy === 1))) {
          statusEl.textContent = 'âŒ ë‚˜ì´íŠ¸ëŠ” Lì í˜•íƒœë¡œë§Œ ì´ë™í•  ìˆ˜ ìˆì–´ìš”!'; return;
        }
      }
      moveHistory.push(current);
      square.el.textContent = ++moveCount;
      square.visited = true;
      if (current) board[current.y][current.x].el.classList.remove('current');
      square.el.classList.add('current');
      current = { x, y };
      clearHints();
      showHints(x, y);

      if (moveCount === size * size) {
        stopTimer();
        const seconds = Math.floor((Date.now() - startTime) / 1000);
        fireConfetti();
        estimateAndRegisterRanking(seconds);
      } else {
        statusEl.textContent = `í˜„ì¬ ì´ë™ ìˆ˜: ${moveCount} / ${size * size}`;
      }
    }

    function fireConfetti() {
      confettiCanvas.style.display = 'block';
      const duration = 2 * 1000;
      const end = Date.now() + duration;
      const confettiInstance = confetti.create(confettiCanvas, { resize: true });
      (function frame() {
        confettiInstance({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 } });
        confettiInstance({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 } });
        if (Date.now() < end) requestAnimationFrame(frame);
        else confettiCanvas.style.display = 'none';
      })();
    }

    function undoMove() {
      if (moveCount === 0 || moveHistory.length === 0) return;
      const { x, y } = current;
      board[y][x].visited = false;
      board[y][x].el.textContent = '';
      board[y][x].el.classList.remove('current');
      current = moveHistory.pop();
      if (current) board[current.y][current.x].el.classList.add('current');
      moveCount--;
      statusEl.textContent = `ë˜ëŒë¦¼ â†’ ì´ë™ ìˆ˜: ${moveCount} / ${size * size}`;
      clearHints();
      if (current) showHints(current.x, current.y);
    }

    function createBoard() {
      size = parseInt(sizeSelect.value);
      boardEl.innerHTML = '';
      board = [];
      moveHistory = [];
      for (let y = 0; y < size; y++) {
        const row = [];
        const tr = document.createElement('tr');
        for (let x = 0; x < size; x++) {
          const td = document.createElement('td');
          td.dataset.x = x;
          td.dataset.y = y;
          td.className = (x + y) % 2 === 0 ? 'light' : 'dark';
          td.addEventListener('click', onClick);
          tr.appendChild(td);
          row.push({ el: td, visited: false });
        }
        board.push(row);
        boardEl.appendChild(tr);
      }
      moveCount = 0;
      current = null;
      clearHints();
      statusEl.textContent = 'ì‹œì‘í•  ì¹¸ì„ í´ë¦­í•˜ì„¸ìš”.';
      timerEl.textContent = '0';
      stopTimer();
      renderRanking();
    }

    function estimateAndRegisterRanking(seconds) {
  const dbPath = window.dbRef(window.db, `rankings/${size}x${size}`);
  const q = window.dbQuery(dbPath, window.dbOrderByChild("time"), window.dbLimitToFirst(1000));

  window.dbGet(q).then(snapshot => {
    const list = [];
    snapshot.forEach(child => list.push(child.val()));
    const rank = list.findIndex(item => seconds < item.time) + 1 || (list.length < 1000 ? list.length + 1 : null);

    const container = document.createElement('div');
    container.style.position = 'fixed';
    container.style.top = '50%';
    container.style.left = '50%';
    container.style.transform = 'translate(-50%, -50%)';
    container.style.background = '#fff';
    container.style.padding = '2rem';
    container.style.border = '1px solid #ccc';
    container.style.boxShadow = '0 0 20px rgba(0,0,0,0.3)';
    container.style.zIndex = '10000';

    const msg = document.createElement('p');
    msg.textContent = `ğŸ‰ ${seconds}ì´ˆë§Œì— í¼ì¦ ì™„ì£¼!
` + (rank ? `ì˜ˆìƒ ìˆœìœ„: ${rank}ìœ„` : '1000ìœ„ê¶Œ ë°–ì…ë‹ˆë‹¤.');
    const input = document.createElement('input');
    input.type = 'text';
    input.placeholder = 'ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
    input.style.width = '100%';
    input.style.margin = '1em 0';

    const btn = document.createElement('button');
    btn.textContent = 'ë“±ë¡í•˜ê¸°';
    btn.style.padding = '0.5em 1em';
    btn.onclick = () => {
      const name = input.value.trim();
      if (name) {
        localStorage.setItem("knightName", name);
        saveRanking(name, seconds);
        document.body.removeChild(container);
        renderRanking();
      }
    };

    container.appendChild(msg);
    container.appendChild(input);
    container.appendChild(btn);
    document.body.appendChild(container);

    // focus default name if stored
    const stored = localStorage.getItem("knightName");
    if (stored) input.value = stored;
  });
}
    }

    function saveRanking(name, seconds) {
      const dbPath = window.dbRef(window.db, `rankings/${size}x${size}`);
      window.dbPush(dbPath, {
        name,
        time: seconds,
        createdAt: Date.now()
      });
    }

    function renderRanking() {
      const dbPath = window.dbRef(window.db, `rankings/${size}x${size}`);
      const q = window.dbQuery(dbPath, window.dbOrderByChild("time"), window.dbLimitToFirst(10));
      window.dbGet(q).then(snapshot => {
        rankingList.innerHTML = "";
        snapshot.forEach((child, index) => {
          const { name, time } = child.val();
          const li = document.createElement("li");
          li.textContent = `${index + 1}. ${name} - ${time}ì´ˆ`;
          rankingList.appendChild(li);
        });
      });
    }

    resetBtn.addEventListener('click', createBoard);
    undoBtn.addEventListener('click', undoMove);
    sizeSelect.addEventListener('change', createBoard);
    window.addEventListener('load', createBoard);
  </script>
  <script type="module">
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBle_FLyJxn7v9AMQXlCo7U7hjcx88WrlU",
  authDomain: "knight-tour-ranking.firebaseapp.com",
  databaseURL: "https://knight-tour-ranking-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "knight-tour-ranking",
  storageBucket: "knight-tour-ranking.firebasestorage.app",
  messagingSenderId: "1073626351852",
  appId: "1:1073626351852:web:41ae6cb7db759beb703dc9",
  measurementId: "G-D2P9PJ00JT"
};


<!-- Firebase SDK -->
<script type="module">
  // Firebase SDK ëª¨ë“ˆ import
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getDatabase, ref, push, get, query, orderByChild, limitToFirst } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

  // âœ… Firebase ì„¤ì • (ë„¤ í”„ë¡œì íŠ¸ì˜ ì‹¤ì œ configë¡œ ë°”ê¿”ì•¼ í•¨)
  const firebaseConfig = {
  apiKey: "AIzaSyBle_FLyJxn7v9AMQXlCo7U7hjcx88WrlU",
  authDomain: "knight-tour-ranking.firebaseapp.com",
  databaseURL: "https://knight-tour-ranking-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "knight-tour-ranking",
  storageBucket: "knight-tour-ranking.firebasestorage.app",
  messagingSenderId: "1073626351852",
  appId: "1:1073626351852:web:41ae6cb7db759beb703dc9",
  measurementId: "G-D2P9PJ00JT"
};


  // Firebase ì´ˆê¸°í™”
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // ì „ì—­ ì°¸ì¡° ë“±ë¡
  window.db = db;
  window.dbRef = ref;
  window.dbPush = push;
  window.dbGet = get;
  window.dbQuery = query;
  window.dbOrderByChild = orderByChild;
  window.dbLimitToFirst = limitToFirst;
</script>

</script>

</body>
</html>

